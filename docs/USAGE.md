# 使用说明

## 1. 安装扩展

1. 执行 `npm install`。
2. 打开 Chrome 的扩展管理页：`chrome://extensions`。
3. 启用开发者模式。
4. 点击“加载已解压的扩展程序”，选择项目根目录或 `dist/extension`。

## 2. 配置飞书凭据（提取飞书文档必填）

1. 点击浏览器工具栏扩展图标。
2. 在页面顶部输入飞书开放平台 `App ID / App Secret`。
3. 点击“保存凭据”。

> 凭据仅存储在本机浏览器扩展 `chrome.storage.local`，不会上传到其他服务。

## 3. 提取公众号或飞书文档内容

1. 点击浏览器工具栏扩展图标。
2. 系统会打开独立分发页面。
3. 在链接输入框粘贴：
   - `https://mp.weixin.qq.com/...`（公众号）
   - `https://*.feishu.cn/docx/...`（飞书文档）
4. 点击“提取正文”。

提取后可查看：

- 标题
- 封面图
- 正文 HTML
- 字数、图片数、段落数
- 完整性校验结果

飞书文档提取策略：

- 优先使用 OpenAPI（结构化 blocks，完整性更高）
- API 失败时自动降级为页面滚动提取

## 4. 内容预览

页面会直接渲染提取后的正文预览，可快速检查：

- 标题是否完整（支持修改标题文本）
- 封面是否识别成功
- 正文段落和图片是否齐全

## 5. 同步到 FoodTalks

1. 点击“同步并保存草稿”或“同步并直接发布”。
2. 系统会打开 `https://admin-we.foodtalks.cn/#/radar/news/publish`。
3. 默认优先触发后台内置“公众号文章采集”，自动导入标题和正文。
4. 若采集按钮/弹窗异常，会自动回退为手动填充标题与正文编辑器。
5. 如果同步失败，会保存回退草稿并在日志中记录失败原因。

## 6. 错误与日志

日志面板会记录提取流程与 FoodTalks 同步流程（进度、重试、失败原因）。

可点击“清空日志”重置。

## 7. 打包发布

执行：

```bash
npm run package
```

生成：

- `dist/fbif-oneclick-publish.crx`
- `dist/fbif-oneclick-publish.zip`
